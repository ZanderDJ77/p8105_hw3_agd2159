---
title: "P8015_Hw3_agd2159"
output: github_document
author: "Zander De Jesus"
date: "10-14-2023"
---
# Problem 1: Instacart Grocery Large-Scale Data Analysis and Plotting

Begin by loading important libraries, organizing markdown, and beginning to pull in full dataset for exploratory data analysis. 

```{r}
library(tidyverse)
library(ggridges)
library(patchwork)
library(p8105.datasets)

#Global Markdown Knitting Settings
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

data("instacart")

summary(instacart)

nrow(instacart)
ncol(instacart)

```


**Task 1 - How many aisles are there, and which aisles are the most items ordered from?**

```{r}

num = instacart |> 
  distinct(aisle_id) |> 
  max()

aisles_df = instacart |> 
  janitor::clean_names() |> 
  group_by(department, aisle) |> 
  summarize(n_obs = n()) |> 
  arrange(desc(n_obs))

aisles_df

```

After creating a separate grouped tibble based on aisle name and the bulk total of orders from each aisle, we can see that the the top 3 aisles with the highest amount of items ordered are **Fresh Vegetables, Fresh Fruits, and Packaged Vegetables / Fruits.** These are then followed by Yogurt and Packaged Cheese in the dairy department. 

**Task 2 - Plotting Number of items sold in highest demand aisles**

```{r}
aisles_df |> 
  filter(n_obs >= 10000) |> 
  ggplot(aes(x=aisle, y = n_obs, fill = department)) + 
  geom_col()

```


Task 3 - 

```{r}

popular_items = instacart |> 
  janitor::clean_names() |> 
  filter(aisle == "baking ingredients" | aisle == "dog food care" | aisle == "packaged vegetables fruits") |> 
  group_by(aisle, product_name) |> 
  summarize(n_obs = n()) |> 
  arrange(desc(n_obs)) |> 
  mutate(item_rank = min_rank(desc(n_obs))) |> 
  filter(item_rank < 4)
           
popular_items |> 
    knitr::kable(digits = 2)

```

Task 4 - 

```{r}
Apple_Coffee = instacart |> 
  select(product_name, order_dow, order_hour_of_day) |> 
  group_by(product_name, order_dow) |> 
  filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") |> 
  mutate(
    order_dow = recode(
      order_dow,
      "0" = "Sunday",
      "1" = "Monday",
      "2" = "Tuesday",
      "3" = "Wednesday",
      "4" = "Thursday",
      "5" = "Friday",
      "6" = "Saturday")) |> 
  summarize(avg_hr = mean(order_hour_of_day)) |> 
  pivot_wider(
    names_from = order_dow,
    values_from = avg_hr)

Apple_Coffee
  
```

